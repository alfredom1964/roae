{"version":3,"sources":["./src/app/pages/reporte/reporte.page.scss","./src/app/pages/reporte/reporte.module.ts","./src/app/pages/reporte/reporte-routing.module.ts","./src/app/pages/reporte/reporte.page.ts","./src/app/pages/reporte/reporte.page.html"],"names":[],"mappings":"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","file":"pages-reporte-reporte-module.js","sourcesContent":["export default \"ion-item {\\n  width: 100%;\\n}\\n\\nion-input {\\n  text-align: right;\\n}\\n\\nion-text {\\n  display: flex;\\n  align-items: center;\\n  width: 100%;\\n  height: 100%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uXFwuLlxcLi5cXC4uXFxyZXBvcnRlLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFdBQUE7QUFDSjs7QUFFQTtFQUNJLGlCQUFBO0FBQ0o7O0FBRUE7RUFDSSxhQUFBO0VBQ0EsbUJBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtBQUNKIiwiZmlsZSI6InJlcG9ydGUucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW9uLWl0ZW0ge1xuICAgIHdpZHRoOiAxMDAlO1xufVxuXG5pb24taW5wdXQge1xuICAgIHRleHQtYWxpZ246IHJpZ2h0O1xufVxuXG5pb24tdGV4dCB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGhlaWdodDogMTAwJTtcbn0iXX0= */\";","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ReportePageRoutingModule } from './reporte-routing.module';\n\nimport { ReportePage } from './reporte.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    ReportePageRoutingModule,\n  ],\n  declarations: [ReportePage],\n  exports: [\n    FormsModule,\n    ReactiveFormsModule,\n  ],\n})\nexport class ReportePageModule {}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ReportePage } from './reporte.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ReportePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ReportePageRoutingModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AuthService } from './../../services/auth.service';\nimport { merge, Observable, Subscription, timer } from 'rxjs';\nimport { ActivatedRoute } from '@angular/router';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport {\n  NativeGeocoder,\n  NativeGeocoderOptions,\n  NativeGeocoderResult,\n} from '@ionic-native/native-geocoder/ngx';\nimport { Router } from '@angular/router';\nimport { FormGroup, FormBuilder, Validators } from '@angular/forms';\nimport { formatDate } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { ThrowStmt } from '@angular/compiler';\nimport { mergeMap } from 'rxjs/operators';\nimport { SMS } from '@ionic-native/sms/ngx';\n\n@Component({\n  selector: 'app-reporte',\n  templateUrl: './reporte.page.html',\n  styleUrls: ['./reporte.page.scss'],\n})\nexport class ReportePage implements OnInit {\n  ionicForm: FormGroup;\n  data = '';\n  reporteId: string;\n  preguntas$: Observable<Array<any>>;\n  reportes$: Observable<Array<any>>;\n  currDate = '';\n  currTime = '';\n  username$: Promise<any>;\n  values = [];\n  subscription: Subscription;\n\n\n  // Location coordinates\n  lat: number;\n  lng: number;\n  accuracy: number;\n  locale: string;\n\n  // Telefono SMS\n // telefono: number;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private authService: AuthService,\n    // private toastController: ToastController,\n    private geolocation: Geolocation,\n    public formBuilder: FormBuilder,\n    private nativeGeocoder: NativeGeocoder,\n    private router: Router,\n    private sms: SMS\n  ) {}\n\n  ngOnInit() {\n    this.reporteId = this.activatedRoute.snapshot.paramMap.get('id');\n    this.preguntas$ = this.authService.getReportDetail(this.reporteId);\n    this.reportes$ = this.authService.getReports();\n    this.currDate = new Date().toLocaleString();\n //   this.currTime = new Date().toLocaleTimeString();\n    this.username$ = this.authService.getUsername();\n    this.getGeolocation();\n    this.startClock();\n    this.subscription = this.preguntas$\n      .pipe(\n        mergeMap(async (preguntas) => {\n          const usuario = await this.username$;\n          return {\n            preguntas,\n            usuario,\n            \n          };\n        })\n      )\n      .subscribe(({ preguntas, usuario }) => {\n        const preguntasObject = {};\n        preguntas.forEach((pregunta, index) => {\n          // Si es 1 le ponemos la hora por valor de defecto\n          if (pregunta.tipo_pregunta_id === '1') {\n            preguntasObject[pregunta.id] = [this.currDate]; \n          } \n          else if (pregunta.tipo_pregunta_id === '3') {\n            preguntasObject[pregunta.id] = ['', [Validators.required]];\n          } else {\n            preguntasObject[pregunta.id] = [false];\n          }\n          // Le ponemos de una vez a la de id uno el valor del usuario, igual no lo puede cambiar\n          if (pregunta.id === '1') {\n            preguntasObject[pregunta.id] = [usuario];\n          }\n          \n        });\n        this.ionicForm = this.formBuilder.group(preguntasObject); console.log(preguntasObject)\n      });\n   \n  }\n\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n  }\n\n  startClock() {\n    timer(0, 1000).subscribe(() => {\n      this.currDate = new Date().toLocaleString();\n    });\n  }\n\n\n  submitForm() {console.log(this.ionicForm.value);\n    this.authService\n      .postReporte({\n        form: this.ionicForm.value,\n        coords: { lat: this.lat, lng: this.lng },\n        reporteId: this.reporteId,\n        \n      })\n      .subscribe();\n  }\n\n  \n\n  //Geocoder configuration\n  geoencoderOptions: NativeGeocoderOptions = {\n    useLocale: true,\n    maxResults: 5,\n  };\n\n  //Get current coordinates of device\n  getGeolocation() {\n    this.geolocation\n      .getCurrentPosition()\n      .then((resp) => {\n        this.lat = resp.coords.latitude;\n        this.lng = resp.coords.longitude;\n        this.accuracy = resp.coords.accuracy;\n\n        this.getGeoencoder(resp.coords.latitude, resp.coords.longitude);\n      })\n      .catch((error) => {\n        alert('Error getting location' + JSON.stringify(error));\n      });\n  }\n\n  //geocoder method to fetch address from coordinates passed as arguments\n  getGeoencoder(latitude, longitude) {\n    this.nativeGeocoder\n      .reverseGeocode(latitude, longitude, this.geoencoderOptions)\n      .then((result: NativeGeocoderResult[]) => {\n        console.log(result[0]);\n      })\n      .catch((error: any) => {\n        alert('Error getting location' + JSON.stringify(error));\n      });\n  }\n}\n\n\n","export default \"<ion-header>\\n  <ion-toolbar>\\n    <ion-button slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"inside\\\"></ion-back-button>\\n    </ion-button>\\n    <div *ngFor=\\\"let reporte of reportes$ | async;  let i = index \\\">\\n      <ion-title *ngIf=\\\"i+1 == reporteId\\\">\\n        Reporte de las {{ reporte.hora[0] }}{{reporte.hora[1]}}:{{ reporte.hora[2] }}{{reporte.hora[3]}}\\n      </ion-title>\\n    </div>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content *ngIf=\\\"ionicForm\\\">\\n  <form [formGroup]=\\\"ionicForm\\\" (ngSubmit)=\\\"submitForm()\\\" novalidate>\\n\\n    <ion-row>\\n      <ion-col size=\\\"4\\\" class=\\\"\\\">\\n        <ion-text>\\n          Latitud:\\n        </ion-text>\\n      </ion-col>\\n      <ion-col>\\n        <ion-input type=\\\"text\\\" name=\\\"lat\\\" value=\\\"{{lat}}\\\" disabled></ion-input>\\n      </ion-col>\\n    </ion-row>\\n\\n     \\n    <ion-row>\\n      <ion-col size=\\\"4\\\" class=\\\"\\\">\\n        <ion-text>\\n          Longitud:\\n        </ion-text>\\n      </ion-col>\\n      <ion-col>\\n        <ion-input type=\\\"text\\\" name=\\\"lng\\\" value=\\\"{{lng}}\\\" disabled></ion-input>\\n      </ion-col>\\n    </ion-row>\\n    \\n    <ion-list>\\n      <ion-item-sliding *ngFor=\\\"let pregunta of preguntas$ | async;  let i = index \\\">\\n\\n        <ion-item *ngIf=\\\"i == '0'\\\">\\n          <ion-label class=\\\"ion-text-wrap\\\">{{pregunta.texto_pregunta}}</ion-label>\\n          <ion-input disabled slot=\\\"end\\\" formControlName=\\\"{{ pregunta.id }}\\\" disabled value=\\\"{{ username$ | async }}\\\">\\n          </ion-input>\\n        </ion-item>\\n\\n        <div *ngIf=\\\"i != '0'\\\">\\n\\n          <ion-item *ngIf=\\\"pregunta?.tipo_pregunta_id == '1'\\\">\\n            <ion-label class=\\\"ion-text-wrap\\\">Fecha/Hora:</ion-label>\\n            \\n            <ion-input name=\\\"hora\\\" [(value)]=\\\"currDate\\\"  formControlName=\\\"{{ pregunta.id }}\\\" slot=\\\"end\\\" disabled>\\n           \\n            </ion-input>\\n          </ion-item>\\n \\n            \\n          <ion-item *ngIf=\\\"pregunta?.tipo_pregunta_id == '2'\\\">\\n            <ion-label class=\\\"ion-text-wrap\\\">{{pregunta.texto_pregunta}}</ion-label>\\n            <ion-checkbox slot=\\\"end\\\" formControlName=\\\"{{ pregunta.id }}\\\"></ion-checkbox>\\n          </ion-item>\\n\\n          <ion-item *ngIf=\\\"pregunta?.tipo_pregunta_id == '3'\\\">\\n            <ion-label class=\\\"ion-text-wrap\\\">{{pregunta.texto_pregunta}}</ion-label>\\n            <ion-input type=\\\"number\\\" placeholder=\\\"Escriba numero\\\" slot=\\\"end\\\" formControlName=\\\"{{ pregunta.id }}\\\"></ion-input>\\n\\n          </ion-item>\\n\\n\\n          <ion-item *ngIf=\\\"pregunta?.tipo_pregunta_id == '4'\\\">\\n            <ion-label class=\\\"ion-text-wrap\\\">{{pregunta.texto_pregunta}}</ion-label>\\n            <ion-input type=\\\"text\\\" placeholder=\\\"Escriba su respuesta\\\" slot=\\\"end\\\" formControlName=\\\"{{ pregunta.id }}\\\">\\n            </ion-input>\\n          </ion-item>\\n        </div>\\n      </ion-item-sliding>\\n    </ion-list>\\n    <ion-button color=\\\"primary\\\" class=\\\"submit-btn\\\" expand=\\\"block\\\" type=\\\"submit\\\" disabled=\\\"{{ ionicForm.invalid }}\\\">Enviar</ion-button>\\n   </form>  \\n  \\n  </ion-content>\\n\";"],"sourceRoot":"webpack:///"}